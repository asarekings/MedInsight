<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedInsight - Advanced Health Analytics</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow/4.10.0/tf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066ff;
            --primary-dark: #0052cc;
            --secondary: #00d4aa;
            --accent: #ff6b6b;
            --bg-dark: #0a0e1a;
            --bg-card: #1a1f35;
            --bg-glass: rgba(26, 31, 53, 0.8);
            --text-primary: #ffffff;
            --text-secondary: #a0a9c0;
            --border: rgba(255, 255, 255, 0.1);
            --shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--primary) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* Navigation */
        .navbar {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 25px;
            padding: 12px 24px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .navbar:hover {
            background: rgba(26, 31, 53, 0.95);
            transform: translateX(-50%) translateY(-2px);
            box-shadow: var(--shadow);
        }

        .nav-items {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-item {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 15px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-item:hover, .nav-item.active {
            color: var(--text-primary);
            background: rgba(102, 126, 234, 0.2);
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Page Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 20px 40px;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .grid {
            display: grid;
            gap: 30px;
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 80px 0;
            background: var(--gradient-primary);
            border-radius: 30px;
            margin-bottom: 60px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: heroFloat 15s linear infinite;
        }

        @keyframes heroFloat {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Buttons */
        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: var(--gradient-secondary);
        }

        .btn-success {
            background: var(--gradient-success);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 15px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        /* Stats Cards */
        .stat-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-success);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 400px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 15px;
            padding: 20px;
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed var(--border);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-upload:hover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.05);
        }

        .file-upload.dragover {
            border-color: var(--secondary);
            background: rgba(0, 212, 170, 0.1);
        }

        /* Results */
        .prediction-result {
            background: var(--gradient-success);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .risk-high { background: var(--gradient-secondary); }
        .risk-medium { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); }
        .risk-low { background: var(--gradient-success); }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                position: relative;
                top: 0;
                left: 0;
                transform: none;
                margin: 20px;
                border-radius: 15px;
            }

            .nav-items {
                flex-wrap: wrap;
                gap: 15px;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 20px;
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Pulse animation for active elements */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-items">
            <div class="logo">MedInsight</div>
            <a href="#" class="nav-item active" data-page="dashboard">Dashboard</a>
            <a href="#" class="nav-item" data-page="predictions">ML Predictions</a>
            <a href="#" class="nav-item" data-page="analytics">Analytics</a>
            <a href="#" class="nav-item" data-page="data">Data Management</a>
            <a href="#" class="nav-item" data-page="compliance">HIPAA</a>
        </div>
    </nav>

    <div class="container">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="hero">
                <div class="hero-content">
                    <h1>Advanced Health Analytics</h1>
                    <p>Revolutionizing healthcare with AI-powered insights, predictive modeling, and HIPAA-compliant data processing</p>
                </div>
            </div>

            <div class="grid grid-4">
                <div class="stat-card">
                    <div class="stat-number" id="totalPatients">2,847</div>
                    <div class="stat-label">Total Patients</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="predictions">1,293</div>
                    <div class="stat-label">ML Predictions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="accuracy">94.7%</div>
                    <div class="stat-label">Model Accuracy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="savings">$2.4M</div>
                    <div class="stat-label">Cost Savings</div>
                </div>
            </div>

            <div class="grid grid-2">
                <div class="card">
                    <h3>Patient Outcome Trends</h3>
                    <div class="chart-container">
                        <canvas id="outcomeChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Risk Distribution</h3>
                    <div class="chart-container">
                        <canvas id="riskChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Real-time Health Metrics</h3>
                <div class="chart-container">
                    <canvas id="metricsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ML Predictions Page -->
        <div id="predictions" class="page">
            <div class="card">
                <h2>Patient Outcome Prediction</h2>
                <p>Advanced ML models for predicting patient outcomes and risk assessment</p>
            </div>

            <div class="grid grid-2">
                <div class="card">
                    <h3>Patient Data Input</h3>
                    <form id="predictionForm">
                        <div class="form-group">
                            <label class="form-label">Age</label>
                            <input type="number" class="form-input" id="age" min="0" max="120" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gender</label>
                            <select class="form-select" id="gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Blood Pressure (Systolic)</label>
                            <input type="number" class="form-input" id="bloodPressure" min="80" max="200" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Cholesterol Level</label>
                            <input type="number" class="form-input" id="cholesterol" min="100" max="400" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">BMI</label>
                            <input type="number" class="form-input" id="bmi" min="15" max="50" step="0.1" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Smoking Status</label>
                            <select class="form-select" id="smoking" required>
                                <option value="">Select Status</option>
                                <option value="never">Never</option>
                                <option value="former">Former</option>
                                <option value="current">Current</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success">Predict Outcome</button>
                    </form>
                </div>

                <div class="card">
                    <h3>Prediction Results</h3>
                    <div id="predictionResults">
                        <p style="text-align: center; color: var(--text-secondary);">Enter patient data to see predictions</p>
                    </div>
                    <div class="loading" id="predictionLoading">
                        <div class="spinner"></div>
                        <p>Analyzing patient data...</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Model Performance Metrics</h3>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analytics" class="page">
            <div class="card">
                <h2>Advanced Analytics Dashboard</h2>
                <p>Comprehensive analysis of health data patterns and trends</p>
            </div>

            <div class="grid grid-3">
                <div class="card">
                    <h3>Disease Prevalence</h3>
                    <div class="chart-container">
                        <canvas id="diseaseChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Age Distribution</h3>
                    <div class="chart-container">
                        <canvas id="ageChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Treatment Outcomes</h3>
                    <div class="chart-container">
                        <canvas id="treatmentChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Correlation Analysis</h3>
                <div class="chart-container">
                    <canvas id="correlationChart"></canvas>
                </div>
            </div>

            <div class="grid grid-2">
                <div class="card">
                    <h3>Temporal Trends</h3>
                    <div class="chart-container">
                        <canvas id="temporalChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Risk Factors Analysis</h3>
                    <div class="chart-container">
                        <canvas id="riskFactorsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Management Page -->
        <div id="data" class="page">
            <div class="card">
                <h2>Data Management & Processing</h2>
                <p>Secure, HIPAA-compliant data handling and processing</p>
            </div>

            <div class="grid grid-2">
                <div class="card">
                    <h3>Data Upload</h3>
                    <div class="file-upload" id="fileUpload">
                        <div style="font-size: 3rem; margin-bottom: 20px;">📁</div>
                        <h4>Drop CSV files here or click to upload</h4>
                        <p style="color: var(--text-secondary); margin-top: 10px;">Supports encrypted CSV files up to 100MB</p>
                        <input type="file" id="fileInput" accept=".csv" multiple style="display: none;">
                    </div>
                </div>

                <div class="card">
                    <h3>Data Processing Status</h3>
                    <div id="processingStatus">
                        <div class="stat-card">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Files Processed</div>
                        </div>
                        <div class="stat-card" style="margin-top: 20px;">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Records Validated</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Data Quality Metrics</h3>
                <div class="chart-container">
                    <canvas id="qualityChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3>Sample Data Structure</h3>
                <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; font-family: monospace;">
                    <pre style="color: var(--text-secondary);">
patient_id,age,gender,blood_pressure,cholesterol,bmi,smoking,outcome
001,45,M,140,220,28.5,former,positive
002,62,F,160,280,32.1,never,negative
003,38,M,120,180,24.3,current,positive
...</pre>
                </div>
            </div>
        </div>

        <!-- HIPAA Compliance Page -->
        <div id="compliance" class="page">
            <div class="card">
                <h2>HIPAA Compliance & Security</h2>
                <p>Ensuring the highest standards of data privacy and security</p>
            </div>

            <div class="grid grid-2">
                <div class="card">
                    <h3>🔒 Security Measures</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 10px 0; border-bottom: 1px solid var(--border);">
                            <strong>End-to-End Encryption</strong><br>
                            <span style="color: var(--text-secondary);">AES-256 encryption for all data</span>
                        </li>
                        <li style="padding: 10px 0; border-bottom: 1px solid var(--border);">
                            <strong>Access Controls</strong><br>
                            <span style="color: var(--text-secondary);">Role-based authentication system</span>
                        </li>
                        <li style="padding: 10px 0; border-bottom: 1px solid var(--border);">
                            <strong>Audit Logging</strong><br>
                            <span style="color: var(--text-secondary);">Complete access and activity tracking</span>
                        </li>
                        <li style="padding: 10px 0;">
                            <strong>Data Anonymization</strong><br>
                            <span style="color: var(--text-secondary);">PHI removal and pseudonymization</span>
                        </li>
                    </ul>
                </div>

                <div class="card">
                    <h3>📋 Compliance Status</h3>
                    <div class="grid grid-2" style="gap: 15px;">
                        <div class="stat-card">
                            <div class="stat-number" style="color: #00d4aa;">✓</div>
                            <div class="stat-label">HIPAA Compliant</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #00d4aa;">✓</div>
                            <div class="stat-label">SOC 2 Certified</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #00d4aa;">99.9%</div>
                            <div class="stat-label">Uptime SLA</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #00d4aa;">0</div>
                            <div class="stat-label">Security Breaches</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Data Processing Agreement</h3>
                <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; max-height: 300px; overflow-y: auto;">
                    <h4>PHI Handling Protocol</h4>
                    <p>All Protected Health Information (PHI) is processed according to HIPAA regulations:</p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>Data is encrypted both in transit and at rest</li>
                        <li>Access is limited to authorized personnel only</li>
                        <li>All access attempts are logged and monitored</li>
                        <li>Data retention policies are strictly enforced</li>
                        <li>Regular security audits are conducted</li>
                    </ul>
                    <p><strong>Data Minimization:</strong> Only necessary data is collected and processed for specific healthcare analytics purposes.</p>
                    <p><strong>User Rights:</strong> Patients have the right to access, modify, or delete their data upon request.</p>
                </div>
            </div>

            <div class="card">
                <h3>Security Audit Log</h3>
                <div class="chart-container">
                    <canvas id="auditChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentModel = null;
        let patientData = [];
        let charts = {};

        // Navigation System
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavigation();
            initializeDashboard();
            initializePredictions();
            initializeAnalytics();
            initializeDataManagement();
            initializeCompliance();
            
            // Animate stats on load
            animateStats();
        });

        function initializeNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const pages = document.querySelectorAll('.page');

            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetPage = item.getAttribute('data-page');
                    
                    // Update navigation
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Switch pages
                    pages.forEach(page => page.classList.remove('active'));
                    document.getElementById(targetPage).classList.add('active');
                    
                    // Initialize page-specific content
                    switch(targetPage) {
                        case 'analytics':
                            initializeAnalyticsCharts();
                            break;
                        case 'compliance':
                            initializeAuditChart();
                            break;
                    }
                });
            });
        }

        function initializeDashboard() {
            // Patient Outcome Trends Chart
            const outcomeCtx = document.getElementById('outcomeChart').getContext('2d');
            charts.outcome = new Chart(outcomeCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Positive Outcomes',
                        data: [85, 87, 91, 89, 94, 96],
                        borderColor: '#00d4aa',
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Complications',
                        data: [15, 13, 9, 11, 6, 4],
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#a0a9c0' } }
                    },
                    scales: {
                        x: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });

            // Risk Distribution Chart
            const riskCtx = document.getElementById('riskChart').getContext('2d');
            charts.risk = new Chart(riskCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Low Risk', 'Medium Risk', 'High Risk'],
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: ['#00d4aa', '#ffeaa7', '#ff6b6b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: { color: '#a0a9c0', padding: 20 }
                        }
                    }
                }
            });

            // Real-time Metrics Chart
            const metricsCtx = document.getElementById('metricsChart').getContext('2d');
            charts.metrics = new Chart(metricsCtx, {
                type: 'bar',
                data: {
                    labels: ['Heart Rate', 'Blood Pressure', 'Temperature', 'Oxygen Sat', 'Glucose'],
                    datasets: [{
                        label: 'Current Values',
                        data: [72, 120, 98.6, 98, 95],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(0, 212, 170, 0.8)',
                            'rgba(255, 107, 107, 0.8)',
                            'rgba(255, 234, 167, 0.8)',
                            'rgba(116, 75, 162, 0.8)'
                        ],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: { ticks: { color: '#a0a9c0' }, grid: { display: false } },
                        y: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });
        }

        function initializePredictions() {
            const form = document.getElementById('predictionForm');
            form.addEventListener('submit', handlePrediction);
            
            // Initialize TensorFlow model (simplified)
            initializeMLModel();
            
            // Performance Chart
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            charts.performance = new Chart(perfCtx, {
                type: 'radar',
                data: {
                    labels: ['Accuracy', 'Precision', 'Recall', 'F1-Score', 'AUC'],
                    datasets: [{
                        label: 'Model Performance',
                        data: [94.7, 92.3, 91.8, 92.0, 96.2],
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderColor: '#667eea',
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#667eea'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#a0a9c0' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            pointLabels: { color: '#a0a9c0' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#a0a9c0' } }
                    }
                }
            });
        }

        async function initializeMLModel() {
            // Create a simple sequential model for demonstration
            currentModel = tf.sequential({
                layers: [
                    tf.layers.dense({ inputShape: [6], units: 64, activation: 'relu' }),
                    tf.layers.dropout({ rate: 0.2 }),
                    tf.layers.dense({ units: 32, activation: 'relu' }),
                    tf.layers.dense({ units: 1, activation: 'sigmoid' })
                ]
            });

            currentModel.compile({
                optimizer: 'adam',
                loss: 'binaryCrossentropy',
                metrics: ['accuracy']
            });

            console.log('ML Model initialized successfully');
        }

        async function handlePrediction(e) {
            e.preventDefault();
            
            const loading = document.getElementById('predictionLoading');
            const results = document.getElementById('predictionResults');
            
            loading.style.display = 'block';
            results.innerHTML = '';
            
            // Collect form data
            const formData = {
                age: parseInt(document.getElementById('age').value),
                gender: document.getElementById('gender').value,
                bloodPressure: parseInt(document.getElementById('bloodPressure').value),
                cholesterol: parseInt(document.getElementById('cholesterol').value),
                bmi: parseFloat(document.getElementById('bmi').value),
                smoking: document.getElementById('smoking').value
            };

            // Simulate prediction processing
            setTimeout(() => {
                const prediction = generatePrediction(formData);
                displayPredictionResults(prediction);
                loading.style.display = 'none';
            }, 2000);
        }

        function generatePrediction(data) {
            // Normalize data for prediction
            const normalizedData = [
                data.age / 100,
                data.gender === 'male' ? 1 : 0,
                data.bloodPressure / 200,
                data.cholesterol / 400,
                data.bmi / 50,
                data.smoking === 'current' ? 1 : (data.smoking === 'former' ? 0.5 : 0)
            ];

            // Simple risk calculation (in real app, use actual ML model)
            let riskScore = 0;
            riskScore += (data.age - 40) * 0.02;
            riskScore += data.bloodPressure > 140 ? 0.3 : 0;
            riskScore += data.cholesterol > 240 ? 0.25 : 0;
            riskScore += data.bmi > 30 ? 0.2 : 0;
            riskScore += data.smoking === 'current' ? 0.4 : (data.smoking === 'former' ? 0.15 : 0);

            const riskPercent = Math.min(Math.max(riskScore * 100, 5), 95);
            const outcome = riskPercent < 30 ? 'low' : (riskPercent < 60 ? 'medium' : 'high');

            return {
                riskScore: riskPercent.toFixed(1),
                outcome: outcome,
                recommendations: generateRecommendations(outcome, data),
                confidence: (85 + Math.random() * 10).toFixed(1)
            };
        }

        function generateRecommendations(risk, data) {
            const recommendations = [];
            
            if (data.bloodPressure > 140) {
                recommendations.push('Monitor blood pressure regularly');
                recommendations.push('Consider cardiovascular consultation');
            }
            
            if (data.cholesterol > 240) {
                recommendations.push('Implement cholesterol management plan');
                recommendations.push('Dietary modifications recommended');
            }
            
            if (data.bmi > 30) {
                recommendations.push('Weight management program advised');
                recommendations.push('Nutritional counseling beneficial');
            }
            
            if (data.smoking === 'current') {
                recommendations.push('Smoking cessation program strongly recommended');
                recommendations.push('Respiratory health monitoring');
            }
            
            if (risk === 'low') {
                recommendations.push('Continue healthy lifestyle practices');
                recommendations.push('Annual health screenings recommended');
            }

            return recommendations;
        }

        function displayPredictionResults(prediction) {
            const results = document.getElementById('predictionResults');
            const riskClass = `risk-${prediction.outcome}`;
            
            results.innerHTML = `
                <div class="prediction-result ${riskClass}">
                    <h3>Risk Assessment: ${prediction.outcome.toUpperCase()}</h3>
                    <div style="font-size: 2rem; font-weight: bold; margin: 15px 0;">
                        ${prediction.riskScore}% Risk Score
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.8;">
                        Model Confidence: ${prediction.confidence}%
                    </div>
                </div>
                
                <div style="margin-top: 25px;">
                    <h4>Clinical Recommendations:</h4>
                    <ul style="margin-top: 15px; padding-left: 20px;">
                        ${prediction.recommendations.map(rec => `<li style="margin-bottom: 8px;">${rec}</li>`).join('')}
                    </ul>
                </div>
                
                <div style="margin-top: 25px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">
                        <strong>Disclaimer:</strong> This prediction is for educational purposes only and should not replace professional medical advice.
                    </p>
                </div>
            `;
        }

        function initializeAnalytics() {
            // Analytics charts will be initialized when the page is accessed
        }

        function initializeAnalyticsCharts() {
            // Disease Prevalence Chart
            const diseaseCtx = document.getElementById('diseaseChart').getContext('2d');
            if (!charts.disease) {
                charts.disease = new Chart(diseaseCtx, {
                    type: 'pie',
                    data: {
                        labels: ['Diabetes', 'Hypertension', 'Heart Disease', 'Obesity', 'Other'],
                        datasets: [{
                            data: [22, 35, 18, 15, 10],
                            backgroundColor: [
                                '#667eea', '#00d4aa', '#ff6b6b', '#ffeaa7', '#764ba2'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                position: 'bottom',
                                labels: { color: '#a0a9c0', padding: 15 }
                            }
                        }
                    }
                });
            }

            // Age Distribution Chart
            const ageCtx = document.getElementById('ageChart').getContext('2d');
            if (!charts.age) {
                charts.age = new Chart(ageCtx, {
                    type: 'bar',
                    data: {
                        labels: ['0-20', '21-40', '41-60', '61-80', '80+'],
                        datasets: [{
                            label: 'Patient Count',
                            data: [145, 487, 892, 756, 234],
                            backgroundColor: 'rgba(0, 212, 170, 0.8)',
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#a0a9c0' }, grid: { display: false } },
                            y: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                        }
                    }
                });
            }

            // Treatment Outcomes Chart
            const treatmentCtx = document.getElementById('treatmentChart').getContext('2d');
            if (!charts.treatment) {
                charts.treatment = new Chart(treatmentCtx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                        datasets: [{
                            label: 'Recovery Rate',
                            data: [20, 35, 55, 70, 85, 92],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#a0a9c0' } } },
                        scales: {
                            x: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                            y: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                        }
                    }
                });
            }

            // Correlation Analysis Chart
            const correlationCtx = document.getElementById('correlationChart').getContext('2d');
            if (!charts.correlation) {
                charts.correlation = new Chart(correlationCtx, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'BMI vs Blood Pressure',
                            data: generateScatterData(50),
                            backgroundColor: 'rgba(102, 126, 234, 0.6)',
                            borderColor: '#667eea'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#a0a9c0' } } },
                        scales: {
                            x: { 
                                title: { display: true, text: 'BMI', color: '#a0a9c0' },
                                ticks: { color: '#a0a9c0' }, 
                                grid: { color: 'rgba(255,255,255,0.1)' } 
                            },
                            y: { 
                                title: { display: true, text: 'Blood Pressure', color: '#a0a9c0' },
                                ticks: { color: '#a0a9c0' }, 
                                grid: { color: 'rgba(255,255,255,0.1)' } 
                            }
                        }
                    }
                });
            }

            // Temporal Trends Chart
            const temporalCtx = document.getElementById('temporalChart').getContext('2d');
            if (!charts.temporal) {
                charts.temporal = new Chart(temporalCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                        datasets: [{
                            label: 'Hospital Admissions',
                            data: [320, 285, 310, 295, 275, 260, 240, 255, 290, 315, 340, 365],
                            borderColor: '#ff6b6b',
                            backgroundColor: 'rgba(255, 107, 107, 0.1)',
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Emergency Cases',
                            data: [85, 92, 78, 88, 95, 102, 110, 98, 85, 79, 88, 94],
                            borderColor: '#ffeaa7',
                            backgroundColor: 'rgba(255, 234, 167, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#a0a9c0' } } },
                        scales: {
                            x: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                            y: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                        }
                    }
                });
            }

            // Risk Factors Analysis Chart
            const riskFactorsCtx = document.getElementById('riskFactorsChart').getContext('2d');
            if (!charts.riskFactors) {
                charts.riskFactors = new Chart(riskFactorsCtx, {
                    type: 'horizontalBar',
                    data: {
                        labels: ['Smoking', 'Poor Diet', 'Sedentary Lifestyle', 'Alcohol', 'Stress', 'Genetics'],
                        datasets: [{
                            label: 'Risk Impact (%)',
                            data: [45, 38, 35, 28, 25, 20],
                            backgroundColor: [
                                '#ff6b6b', '#ffeaa7', '#00d4aa', '#667eea', '#764ba2', '#f093fb'
                            ],
                            borderRadius: 5
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                            y: { ticks: { color: '#a0a9c0' }, grid: { display: false } }
                        }
                    }
                });
            }
        }

        function generateScatterData(count) {
            const data = [];
            for (let i = 0; i < count; i++) {
                const bmi = 18 + Math.random() * 20;
                const bp = 90 + bmi * 1.5 + Math.random() * 30;
                data.push({ x: bmi, y: bp });
            }
            return data;
        }

        function initializeDataManagement() {
            const fileUpload = document.getElementById('fileUpload');
            const fileInput = document.getElementById('fileInput');

            fileUpload.addEventListener('click', () => fileInput.click());
            fileUpload.addEventListener('dragover', handleDragOver);
            fileUpload.addEventListener('drop', handleFileDrop);
            fileUpload.addEventListener('dragleave', handleDragLeave);
            
            fileInput.addEventListener('change', handleFileSelect);

            // Initialize data quality chart
            const qualityCtx = document.getElementById('qualityChart').getContext('2d');
            charts.quality = new Chart(qualityCtx, {
                type: 'bar',
                data: {
                    labels: ['Completeness', 'Accuracy', 'Consistency', 'Validity', 'Uniqueness'],
                    datasets: [{
                        label: 'Quality Score (%)',
                        data: [95, 92, 88, 97, 94],
                        backgroundColor: [
                            'rgba(0, 212, 170, 0.8)',
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(255, 234, 167, 0.8)',
                            'rgba(116, 75, 162, 0.8)',
                            'rgba(255, 107, 107, 0.8)'
                        ],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#a0a9c0' }, grid: { display: false } },
                        y: { 
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#a0a9c0' }, 
                            grid: { color: 'rgba(255,255,255,0.1)' } 
                        }
                    }
                }
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('dragover');
        }

        function handleFileDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            processFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            processFiles(files);
        }

        function processFiles(files) {
            const statusDiv = document.getElementById('processingStatus');
            let filesProcessed = 0;
            let recordsValidated = 0;

            Array.from(files).forEach((file, index) => {
                if (file.type === 'text/csv' || file.name.endsWith('.csv')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const csv = e.target.result;
                        Papa.parse(csv, {
                            header: true,
                            skipEmptyLines: true,
                            complete: function(results) {
                                filesProcessed++;
                                recordsValidated += results.data.length;
                                
                                // Update status display
                                statusDiv.innerHTML = `
                                    <div class="stat-card pulse">
                                        <div class="stat-number">${filesProcessed}</div>
                                        <div class="stat-label">Files Processed</div>
                                    </div>
                                    <div class="stat-card pulse" style="margin-top: 20px;">
                                        <div class="stat-number">${recordsValidated}</div>
                                        <div class="stat-label">Records Validated</div>
                                    </div>
                                `;
                                
                                // Store processed data (in memory only)
                                patientData = [...patientData, ...results.data];
                                
                                console.log(`Processed ${file.name}: ${results.data.length} records`);
                            }
                        });
                    };
                    reader.readAsText(file);
                } else {
                    alert('Please upload CSV files only.');
                }
            });
        }

        function initializeCompliance() {
            // Compliance page is already set up with static content
        }

        function initializeAuditChart() {
            const auditCtx = document.getElementById('auditChart').getContext('2d');
            if (!charts.audit) {
                charts.audit = new Chart(auditCtx, {
                    type: 'line',
                    data: {
                        labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                        datasets: [{
                            label: 'Access Attempts',
                            data: [12, 8, 45, 67, 52, 23],
                            borderColor: '#00d4aa',
                            backgroundColor: 'rgba(0, 212, 170, 0.1)',
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'Failed Logins',
                            data: [2, 1, 3, 4, 2, 1],
                            borderColor: '#ff6b6b',
                            backgroundColor: 'rgba(255, 107, 107, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { labels: { color: '#a0a9c0' } } },
                        scales: {
                            x: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                            y: { ticks: { color: '#a0a9c0' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                        }
                    }
                });
            }
        }

        function animateStats() {
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach((stat, index) => {
                const finalValue = stat.textContent;
                let currentValue = 0;
                const increment = finalValue.replace(/[^\d]/g, '') / 50;
                const suffix = finalValue.replace(/[\d.]/g, '');
                
                const timer = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= finalValue.replace(/[^\d]/g, '')) {
                        stat.textContent = finalValue;
                        clearInterval(timer);
                    } else {
                        stat.textContent = Math.floor(currentValue) + suffix;
                    }
                }, 50 + index * 10);
            });
        }

        // Update real-time data
        setInterval(() => {
            if (charts.metrics && document.getElementById('dashboard').classList.contains('active')) {
                // Update real-time metrics with slight variations
                const currentData = charts.metrics.data.datasets[0].data;
                charts.metrics.data.datasets[0].data = currentData.map(val => 
                    val + (Math.random() - 0.5) * 2
                );
                charts.metrics.update('none');
            }
        }, 5000);

        // Auto-save functionality (in memory only)
        let autoSaveData = {};
        
        function autoSave() {
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                const formData = new FormData(form);
                const data = {};
                for (let [key, value] of formData.entries()) {
                    data[key] = value;
                }
                autoSaveData[form.id] = data;
            });
        }

        // Auto-save every 30 seconds
        setInterval(autoSave, 30000);

        // PWA Service Worker Registration (for GitHub Pages)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful');
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>
                